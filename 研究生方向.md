[TOC]
# 植物基因组结构与演化机制
1. 基因组结构包括哪些？
   1. 染色体上DNA序列中的各类顺式作用元件、甲基化修饰以及组蛋白上的各类修饰？
2. 什么是演化？
   1. 植物基因组在不同的外界条件下所发生的差异性的现象？针对这样的差异进行多个层次的组学比较，寻找差异与共同？
整个方向应该是针对系统发育树（采用DNA/蛋白质序列or基因组构建，应当选择合适的建树方法）中临近或者同属一类物种的植物，研究在一定时间内发生了性状的变化（如环境适应性或者说其他的变化）。对这背后的一系列因素（基因的变异，基因组的变异以及甚至[甲基化和组蛋白上修饰的变化？？？？]在其中发挥的作用）。
>可否考虑，相近物种或者相近基因之间，其具备的各类修饰之间的差异：比如对于一种组蛋白修饰，在多个物种的整个基因组上的修饰情况，是否可以根据这样的多个物种的修饰情况**去构建一个算法来描述他们的相似性或者差异性？或者也可以根据这样的特点，作为深度学习输入特征，去train一个黑盒模型？**

**简而言之对于多个编码基因之间可以进行的研究有：**
   1. 基因之间的**核苷酸趋异度**，以及编码的蛋白质序列之间的核苷酸趋异度以及自然选择强度
   2.**密码子使用频率**、每个位点的潜在同义位点和潜在非同义位点
   3. **开放阅读框的移码**
   4. 同源基因之间的产生机制，根据同源基因的突变情况、***根据新基因产生的机制去判断是否存在这样的一些机制，是否可以写代码去做？***
      1. 复制产生？
>需要搞清楚 **新基因产生的机制**以及**研究基因进化的常用策略**和**研究基因组进化的常用策略**

**但是有一个问题，研究这个的目标在哪里？？**
答：搞清楚所研究的**同源基因之间的产生关系，进化关系，分析其产生与环境的相互作用关系**。搞清楚所研究的临近物种之间 **基因组中的各类同源基因的产生关系和进化关系、搞清楚基因组之间所发生的各类变异（全基因组拷贝事件等？）**


## 思路
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063108.jpg)
课程：
    1.manolis kellis 的生物学中机器学习 17-21
[连接](https://www.youtube.com/watch?v=CTPs5HELLpo&list=PLypiXJdtIca6dEYlNoZJwBaz__CdsaoKJ)
   2.   [生信撰](https://space.bilibili.com/351505489/channel/detail?cid=155116&ctype=0)

需要：
1. 利用基因组的序列进行比较， 如何可视化？如何寻找序列中的各类信息与比较。



## 方法

如果需要对同源基因进行研究，我认为首先需要找到 **一些评估标准** 来衡量同源基因之间的进化程度。

这样的评估标准，目前似乎用的最多的是基于**分子钟理论**的各种模型。对于这些模型，我认为需要满足**在给定的基因集（训练集）需要满足，模型生成的一系列结果或者说各种描述符？ 与这些基因所对应的一系列分歧时间是成正比的或者近似正比**
如：
   1. **核苷酸趋异度**
   2. **是否可以考虑使用深度学习模型来train？**

### 自然选择的常用方法
在种间同源基因中， 计数同义（$k_s$）和非同义氨基酸替换（$k_a$）其中当：
    1.$\omega = \frac{k_a}{k_s} > 1$ 意味着基因呈现正选择 
    2.$\omega = \frac{k_a}{k_s} = 1$中性进化
    3.$\omega = \frac{k_a}{k_s} < 1$负选择
> 这样的方法会存在的一个问题就是，部分位点可能是受到正选择，而周围的位点可能不同或者相反，而从整个基因或者长序列的角度看就会得到相反的结果。
> 一个解决方式就是同时进行 种内和种间的同源基因的比较。

另外一种方法是**利用相对速率检验**，这种方法需要至少三个相关物种：两个非常相近的物种和一个远亲代表。 在近亲之间比较替换速率，然后在与远亲分别进行比较替换速率（也就是上一种方法的比值？）是否相似。如果两种近亲分别于远亲代表进行得到的替换速率是不同的则说明两个近亲之间存在自然选择？？？

还有一种方法是 **估算特定遗传基因座的多态性**
> 核苷酸趋异度（$\pi$）应该是两条序列之间存在差异的核苷酸个数与总核苷酸的个数，是一个百分数。一般呢两条序列之间应该是存在较长的时间跨度，这个跨度以百万年为单位，这样趋异度就变成了每百万年的百分比差异。因此也可以用**单位进化时期 the unit evolutionary period, UEP**来衡量，也就是产生1%的趋异度所用的时间。
#### 选择压力的计算
#####   选择压力的意义
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063111.jpg)
##### 选择压力分析的流程
使用的软件：PAM 
选择感兴趣的基因
1. 挑选出所有的同源基因（选择生活环境相似或者近源的物种的同源基因）
2. 构建系统发育树（有根树） 
3. 使用paml中的yn00计算$k_a和k_s$
4. 剔除旁系同源基因
5. 使用codeml计算 正选择分析

### 多基因组之间的比较方法

systeny alignment 也就是对两个或者多个物种间的染色体进行比对，寻找保守的同向的区域块，也就是shared systeny。shared systeny 可以用于**确定多个物种间的基因组区域的同源性**，**极度保守的systeny可以反映这些区域之间基因的基因组所具备的重要功能关系**![image-20210904154218719](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-09-04-074219.png)
>systeny 是指的两个染色体之间所具备的相似的且同向的区域，如上图中，两个物种间用同样颜色标记出来的区域。右边是老鼠的，左边是人的基因组，同色则表示人的某条染色体上的某些序列与老鼠的对应颜色的染色体的区域有相似性。更多可以参见：https://en.wikipedia.org/wiki/Synteny#Shared_synteny

此外还有采用比较基因组学的方法~
## 基本理论
基因组结构与演化机制

### 分子钟
在同类的核苷酸序列中，序列会以一个固定的 **速率** 进行替换累积，也就是该两对核苷酸序列和编码的蛋白质序列之间的差异度或多或少与它们分开后的时间成正比，也就是分子钟理论。
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063112.jpg)
其中在核苷酸序列中， 同义位点和非同义位点以及整个序列所计算得到的趋异度的差异会比较大，尤其是同义位点和非同义位点之间。通常采用 **非同义位点来进行分子钟的建立**，而非采用同义位点（数据是不大明确的，并且波动范围太大等原因导致？）。
> 从下图可以看到同义位点在较长的时间趋异度是不恒定的。
> ![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063113.jpg)

### 分子进化
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063114.jpg)
首先第一步就是需要对序列进行比较，采用一种衡量方式来描述序列之间的差异，通过这样的差异构建系统发育树。

序列比较中的一些常见描述如下
1. orthologs: a speciation event （物种形成事件） 。orthologs也就是直系同源序列，两个基因通过**物种形成事件**而产生或者不同物种最近的共同祖先的两个基因，或者两个物种中的同一基因。
2. paralogs: a duplication event  paralogs也就是（旁系同源序列），**两个基因在同一物种中，通过基因复制产生的。**

![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063115.jpg)

xenologs: horizontal(or lateral) gene transfer event， xenologs（异同源序列），水平基因转移事件而产生的同源序列
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063117.jpg)


下面先列举密码子相关的分析

#### 密码子偏好及相关性分析
在随机，无自然选择的情况下，各个密码子的出现频率将大致相等。**但是存在由于tRNA的丰度在不同物种之间存在差异，因此使用的不同的同义密码子会对表达量有影响**
，密码子偏好性就是这个现象。
>![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063118.jpg)
在这里首先讨论密码子偏好性相关的分析。

可以衡量自然选择的强度，见**方法**

其中有关密码子的几个数学描述符：
#####  RSCU是相对密码子使用频率
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063119.jpg)
其中$X_{ij}$是编码第i个氨基酸的**第j个密码子的个数**
RSCU也就是密码子在序列中观测到的个数比上这个序列中编码该氨基酸的所有同义密码子的个数。
##### $w_{ij}$ 描述密码子的相对适应性ß
$w_{ij} = \frac{RSCU_{ij}}{RSCU_{imax}} = \frac{X_{ij}}{X_{imax}}$
也就是出现某个密码子在序列中出现的次数比上它的同义密码子（出现次数最多的那个）的次数
##### CAI：codon Adaptation Index
$CAI = \frac{CAI_{obs}}{CAI_{max}}$
其中 $CAI_{obs} = \sqrt[L]{\prod_{k=1}^LRSCU_k}$；
而$CAI_{max} = \sqrt[L]{\prod_{k=1}^{L}RSCU_{kmax}}$
L为序列长度。
也就是：
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063120.jpg)
最后合并公式 $CAI = \sqrt[L]{\prod_{k=1}^L w_k}$


##### 密码子偏好性的应用及计算
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063122.jpg)

以上为密码子偏好部分内容，详细的方法见**方法部分**
#### 氨基酸序列的进化演变
相对于DNA序列而言，氨基酸序列比较更为保守，仅仅DNA序列上的非同义突变的结果会在氨基酸序列显现。
而描述两条氨基酸序列之间的趋异度 的数学模型有许多。
首先需要进行序列比较，然后才可以进行距离的计算
##### p距离 p-distance 

**删除所有的插入缺失**之后，$\hat{p} = \frac{n_d}{n} $
其中所有序列的氨基酸数目为n，两条序列间的差异氨基酸个数为$n_d$。
##### 泊松矫正 possion correction, d-dsitance
描述的是某个时间段内，事件发生的次数的概率
泊松分布 $P\{X=k\} = \frac{\lambda^k e^{-\lambda}}{k!}$ 其中$\lambda$为期望，也就是一个**时间段内**发生的次数的期望值

*也可以近似用二项分布估计，不过似乎太麻烦，这部分作为补充资料*
这个时候引入二项分布，二项分布也是$X$~$B(n,p)$其中n为实验的次数，p为事件发生的概率。
当n很大而p很小的时候，就可以近似为符合泊松分布，这个时候$\lambda = np$ 也就是$P\{X=k \} = C_n^kP^k(1-p)^k = \frac{(np)^ke^{-(np)}}{k!}$

注意！
假设：
1. 氨基酸序列中某一个位点每年的氨基酸替代率为$\gamma$，并且假设每个位点的$\gamma$相等。
2. 假设在分歧时间t年后，这段时间内**该位点发生氨基酸替代数的次数符从泊松分布**。
3. t时间较短，回复突变的情况可以忽略不计（这也是问题，因此t不可以太长）
因此这段时间（t)内，一个位点中发生的氨基酸替代数的概率服从泊松分布，并且$\lambda = \gamma t$。则发生k次突变时$P\{X = k;t\} = \frac{(\gamma t)^ke^{-(\gamma t)}}{k!}$
所以，某一位点氨基酸不变的概率为$P(0;t)=e^{-\gamma t}$
>注 $0! = 1$

因此这个时候就得到了，两条分化t年的序列，一条序列无替代的概率为$e^{-\gamma t}$则 两条序列从分歧开始后的t年，均无替代的概率为$q= (e^{-\gamma t})^2$
**这一步如何得来尚有疑惑！！！**
则两条序列有差异（也就是**两条序列非0突变的情况**）为$p = 1-q$，而$p$就是两条序列之间的差异发生的概率
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063123.jpg)
#### DNA序列的进化演变
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063125.jpg)
如何描述两条DNA序列的差异？采用一系列进化模型来描述序列之间的趋异度。
其中最简单的方式为$\hat{p} = \frac{n_d}{n}$，$n_d$为不同的碱基对
但是核苷酸之间的替代存在**颠换和转换**，发生的概率概率是有所差异。
模型见下图。
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063127.jpg)

##### 此外呢 从同义与非同义的核苷酸的替代的角度也可以来描述
首先$K_a和K_s$的计算和含义是有所差异的（方法部分中的$K_a和K_s$是对整个序列进行讨论，这儿离则是对于每个位点进行）
详细见图
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063128.jpg)
其中4个参数的计算：
$S$潜在的同义位点，**也就是该位点的氨基酸所对应的密码子**，寻找该密码子的所有同义密码子，其中**第一个碱基突变为另外3个碱基有$m_1$种情况为同义突变**，相应的第二个碱基，第三个碱基有$m_2和m_3$，则$S = \frac{(m_1+m_2+m_3)}{3}$。显然$S$最大为3，也就是所有的突变情况均是同义突变，这个模拟的是**该密码子只发生一次突变的所有可能性中的同义突变情况**
$N$潜在的非同义位点，$N= 3-S$。可以参见下图
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063130.jpg)
>计算完单个位点的S和N后，可以计算相应的整个序列的s和n，也就是每一个密码子的S和N分别求和。且总的 s+n = 序列的长度，**见上图**


- 相关的计算方法有：
1. 进化通经法
也就是一对密码子，由$A \rightarrow B$ 让A一次只有一个碱基发生突变，然后再一次发生一个碱基突变，最终让A变成B。这个过程中涉及到的突变结果应该均是密码子，并且不包括终止子的密码子（有则不考虑这条路径），这样可以穷举出所有的路径（$r$）。
随后$s_d = s_s/n_r$其中$s_s是 所有的路径中发生同义突变的次数，而$n_r$则是路径的个数$
同理$n_d = s_a/n_r$其中$s_a是 所有的路径中发生非同义突变的次数，而$n_r$则是路径的个数$
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063132.jpg)
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063133.jpg)
也就是
## 名词注释
遗传变异（variation）
变异分选（sorting）

颠换突变（Transversion mutation）嘧啶到嘌呤
转换突变（transition mutation） 嘧啶之间或者嘌呤之间的转化

同义突变（synonymous mutation）
沉默突变（silent mutation）
非同义突变（nonsynonymous mutation）
错义突变（missense mutation）和非同义突变相同
无义突变（nonsense mutation）产生终止密码子的突变
中性突变（neutral mutation） 对表型无影响的突变

遗传漂变（genetic drift）指的是大群体中仍然满足孟德尔式的遗传定律，但是在一些小群体中可能会出现较大的差异，甚至缺失一个等位基因的现象。 因此遗传漂变是一个随机过程（类似量子玄学？？） 因此在1个给定的基因座，可能存在随机的波动变化，尤其是在某些小群体中，因为它们的保留或者丢失会更快。

正选择（positive selection） **处于正选择下也就是氨基酸改变时有利的**，外显子序列会变化多端而内含子序列相对保守。会保留非同义突变的结果
负选择（negative selection）负选择下也就是氨基酸的改变时有害的或者**倾向于保留原有的氨基酸顺序**，外显子区域会趋近保守而内含子序列变化多端（因为自然选择会倾向于消除突变产生的表现因此，外显子区域会保守而内含子无法影响表型）。会保留同义突变的结果

杂合性（heterozygosity）
遗传搭乘（genetic hitchhiking） 变异序列对个体有利，那么这个位点将会显示为核苷酸杂合性的降低，变异体在频率上会增加，并最终固定于群体中的现象。

趋异度（divergence）趋异度指的是 两个基因之间的差异

回复突变（recurrent mutation）


## 数理基础
### 统计学部分
首先要明确分布，离散分布和连续性分布。
对于一个分布而言还有概率密度函数（$f(x)$)和累积函数$F(x)$，二者之间的关系如下图：
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063135.jpg)
其中在生物信息学课程中讨论常讨论离散分布，大概是因为生物学相关的许多数学模型的基础便是此。
1.二项分布
2.泊松分布
3.超几何分布
**以下主要着重记录这样的分布在生物信息学中的应用**
#### 二项分布
>复制基因与已有的基因的功能关系有以下两种观点（见图）
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063136.jpg)

以酵母的两个种与另外一种酵母的关系看，存在这样的关系（通过比较序列的差异，采用UWGET的方式构建进化树）：
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-63139.jpg)
可以看到如图的关系

其中最后得到的结论：
1.**酵母中457对通过全基因组复制产生的复制基因对（也就是914个基因），在酿酒酵母中76对有加速进化的现象，其中4对是两个基因（也就是酿酒酵母和贝克酵母中）均加速进化。**

可以使用二项分布来理解这个现象。
假设：基因与基因之间是相互独立，互不影响的受到自然选择从而加速进化或者不变。

因此可以认为914个基因中的任意一个基因发生加速进化的概率为$80/914 = 0.088 = p_0$
也就是914个基因中有$X$个基因发生加速进化，其中$P \sim B(p_0=0.088,914)$

这里Manalis Kellis等人在酵母的全基因组这篇文章（2004年）中研究是把一对基因看做一次独立的事件进行统计模型构建，见PPT：
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063139.jpg)

关于这样构建统计模型的前提假设不同所会导致的问题则不在这里讨论。

#### 泊松分布

一个比较好验证数据是否符合泊松分布的方法是：**数据的方差和均值是否相等**



##### 一个应用是测序技术，reads的覆盖率的数学模型中
在reads覆盖率中的模型中，著名的Lader-Waterman Model便是采用泊松分布进行估计的。

假设：
1. 基因组上任一点位X被覆盖K次的概率是服从泊松分布的，并且均值为$\mu$，则$P(X = k) = \frac{e^{-\mu}\mu ^k}{k!}$
>点X一次不被覆盖的概率为$P(X=0) = e^{-\mu}$
2. 总共测序的序列数量为：N；测序的BAC长度为200kbp；每次测序：500bp；每次测序的覆盖率p：$500/200kbp=0.0025$；因此：总覆盖率$c = Np（每个点平均覆盖到的次数）$ 也就是$c = \mu$
覆盖率也就是 测序过程中提到的**多少$X$**，如：100X也就是c = 100。即$P(X = k) = \frac{e^{-100}100 ^k}{k!}$
注意的是，并不是每一个位点都被测了100次。
c越大带来的好处就是$P\{X \geq 0\} = 1 - P\{x =0\} = 1 - e^{-100}$也就是未被测序到的位点的概率越低。
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063141.jpg)
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-63142.jpg)
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063143.jpg)
##### 另外一个例子
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063144.jpg)


>至于为什么采用泊松分布，我猜测可能是在对数据拟合的过程中发现更符合泊松分布吧~

#### 超几何分布
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063149.jpg)
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063150.jpg)
![](https://tf-picture-bed-1259792641.cos.ap-beijing.myqcloud.com/blog/2021-08-18-063155.jpg)